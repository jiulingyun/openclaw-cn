name: Upstream Copilot Resolve
# å°† cherry-pick å†²çªçš„ commit åˆ†é…ç»™ GitHub Copilot Agent è‡ªåŠ¨è§£å†³
# æ”¯æŒ: æ‰‹åŠ¨è§¦å‘ / upstream-cherry-pick è‡ªåŠ¨è°ƒç”¨

on:
  workflow_dispatch:
    inputs:
      from_tag:
        description: 'èµ·å§‹ç‰ˆæœ¬'
        type: string
        default: 'auto'
      to_tag:
        description: 'ç›®æ ‡ç‰ˆæœ¬'
        type: string
        default: 'latest'
      priority:
        description: 'åˆå¹¶ä¼˜å…ˆçº§'
        type: choice
        options:
          - 'P0'
          - 'P0,P1'
          - 'P0,P1,P2'
        default: 'P0,P1'
      issue_number:
        description: 'å…³è”çš„ä¸Šæ¸¸æ›´æ–° Issue ç¼–å· (å¯é€‰)'
        type: string
        default: ''
      max_issues:
        description: 'æœ€å¤šåˆ›å»ºå¤šå°‘ä¸ª Copilot Issue (0=ä¸é™)'
        type: number
        default: 5
      dry_run:
        description: 'ä»…é¢„è§ˆï¼Œä¸åˆ›å»º Issue'
        type: boolean
        default: true

  workflow_call:
    inputs:
      from_tag:
        type: string
        default: 'auto'
      to_tag:
        type: string
        default: 'latest'
      priority:
        type: string
        default: 'P0,P1'
      issue_number:
        type: string
        default: ''
      max_issues:
        type: number
        default: 10
      dry_run:
        type: boolean
        default: false

permissions:
  contents: read
  issues: write

jobs:
  resolve:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Setup upstream remote
        run: |
          git remote add upstream https://github.com/openclaw/openclaw.git 2>/dev/null || true
          git fetch upstream --tags --force
          git fetch upstream main

      - name: Resolve tags
        id: tags
        run: |
          FROM="${{ inputs.from_tag }}"
          TO="${{ inputs.to_tag }}"

          if [ "$FROM" = "auto" ] || [ -z "$FROM" ]; then
            if [ -f ".github/last-upstream-tag" ]; then
              FROM=$(cat .github/last-upstream-tag | tr -d '[:space:]')
            else
              echo "::error::No .github/last-upstream-tag found"
              exit 1
            fi
          fi

          if [ "$TO" = "latest" ] || [ -z "$TO" ]; then
            TO=$(git tag -l 'v*' --sort=-version:refname | grep -v '-' | head -1)
          fi

          echo "from=$FROM" >> "$GITHUB_OUTPUT"
          echo "to=$TO" >> "$GITHUB_OUTPUT"
          echo "Range: $FROM â†’ $TO"

      # ============================================================
      # æ­¥éª¤ 1: è¯†åˆ«å†²çª commit
      # ============================================================
      - name: Detect conflicting commits
        id: conflicts
        run: |
          FROM="${{ steps.tags.outputs.from }}"
          TO="${{ steps.tags.outputs.to }}"
          P_FILTER=$(echo "${{ inputs.priority }}" | tr ',' '|' | tr '[:lower:]' '[:upper:]')

          # ç”Ÿæˆ commit æ˜ å°„
          chmod +x scripts/upstream-extract-commits.sh
          ./scripts/upstream-extract-commits.sh "$FROM" "$TO" > /tmp/all-commits.json 2>/dev/null

          # ç­›é€‰ MERGE ä¼˜å…ˆçº§
          jq --arg p "$P_FILTER" \
            '[.[] | select(.action == "MERGE" and (.priority | test("^(\($p))$")))]' \
            /tmp/all-commits.json > /tmp/merge-commits.json

          TOTAL=$(jq 'length' /tmp/merge-commits.json)
          echo "å¾…æ£€æµ‹ commit: $TOTAL ä¸ª"

          # é€ä¸ªå°è¯• cherry-pick è¯†åˆ«å†²çª
          CONFLICTS="[]"
          SUCCESS=0
          CONFLICT=0

          git config user.name "conflict-detect[bot]"
          git config user.email "bot@openclaw-cn.dev"

          for SHA in $(jq -r '.[].sha' /tmp/merge-commits.json); do
            if git cherry-pick "$SHA" --no-commit 2>/dev/null; then
              git reset --hard HEAD 2>/dev/null
              SUCCESS=$((SUCCESS + 1))
            else
              git cherry-pick --abort 2>/dev/null || git reset --hard HEAD 2>/dev/null

              # æ”¶é›†å†²çªä¿¡æ¯
              INFO=$(jq -r ".[] | select(.sha == \"$SHA\")" /tmp/merge-commits.json)
              MSG=$(echo "$INFO" | jq -r '.message')
              PRIORITY=$(echo "$INFO" | jq -r '.priority')
              CATEGORY=$(echo "$INFO" | jq -r '.category')

              # è·å–æ¶‰åŠçš„æ–‡ä»¶åˆ—è¡¨
              FILES=$(git show "$SHA" --format="" --name-only | tr '\n' ',' | sed 's/,$//')

              # è·å– diff è¡Œæ•°ä¼°ç®—ï¼ˆç”¨äºåˆ†ç»„ç­–ç•¥ï¼‰
              DIFF_LINES=$(git show "$SHA" --format="" --stat | tail -1 | grep -oP '\d+ insertion|d+ deletion' | head -1 | grep -oP '\d+' || echo "0")

              # æå–æ¨¡å—åï¼ˆä» commit message æˆ–æ–‡ä»¶è·¯å¾„ï¼‰
              MODULE=$(echo "$MSG" | grep -oP '^\w+\((\K[^)]+)' || echo "$FILES" | cut -d'/' -f2 | head -1)
              [ -z "$MODULE" ] && MODULE="other"

              CONFLICTS=$(echo "$CONFLICTS" | jq \
                --arg sha "$SHA" \
                --arg msg "$MSG" \
                --arg priority "$PRIORITY" \
                --arg category "$CATEGORY" \
                --arg files "$FILES" \
                --arg module "$MODULE" \
                --arg diff_lines "$DIFF_LINES" \
                '. + [{sha: $sha, message: $msg, priority: $priority, category: $category, files: $files, module: $module, diff_lines: ($diff_lines | tonumber)}]')

              CONFLICT=$((CONFLICT + 1))
            fi
          done

          echo "$CONFLICTS" > /tmp/conflicts.json

          echo "conflict_count=$CONFLICT" >> "$GITHUB_OUTPUT"
          echo "success_count=$SUCCESS" >> "$GITHUB_OUTPUT"
          echo "total=$TOTAL" >> "$GITHUB_OUTPUT"

          echo ""
          echo "========================================="
          echo "ğŸ” å†²çªæ£€æµ‹ç»“æœ:"
          echo "   âœ… å¯ç›´æ¥ cherry-pick: $SUCCESS"
          echo "   âŒ éœ€ Copilot å¤„ç†:    $CONFLICT"
          echo "========================================="

      # ============================================================
      # æ­¥éª¤ 2: æŒ‰æ¨¡å—åˆ†ç»„å†²çª commit
      # ============================================================
      - name: Group conflicts by module
        id: groups
        if: steps.conflicts.outputs.conflict_count != '0'
        run: |
          # æŒ‰ module åˆ†ç»„, æ¯ç»„æœ€å¤š 5 ä¸ª commit (é¿å… Issue è¿‡å¤§)
          MAX_PER_GROUP=5
          jq --argjson max "$MAX_PER_GROUP" '
            group_by(.module)
            | [.[] | {
                module: .[0].module,
                commits: .,
                count: length,
                priorities: [.[].priority] | unique | join(",")
              }]
            | [.[] |
                if .count <= $max then .
                else
                  range(0; .count; $max) as $i |
                  {
                    module: (.module + (if $i > 0 then "-part\(($i / $max) + 1 | floor)" else "" end)),
                    commits: .commits[$i:$i+$max],
                    count: ([.count - $i, $max] | min),
                    priorities: .commits[$i:$i+$max] | [.[].priority] | unique | join(",")
                  }
                end
              ]
            | sort_by(.priorities)
          ' /tmp/conflicts.json > /tmp/groups.json

          GROUP_COUNT=$(jq 'length' /tmp/groups.json)
          echo "group_count=$GROUP_COUNT" >> "$GITHUB_OUTPUT"

          echo ""
          echo "ğŸ“¦ åˆ†ç»„ç»“æœ ($GROUP_COUNT ç»„):"
          jq -r '.[] | "  [\(.module)] \(.count) ä¸ª commit (\(.priorities))"' /tmp/groups.json

      # ============================================================
      # æ­¥éª¤ 3: é¢„è§ˆ (dry_run) æˆ–åˆ›å»º Issue
      # ============================================================
      - name: Preview mode
        if: inputs.dry_run && steps.conflicts.outputs.conflict_count != '0'
        run: |
          {
            echo "## ğŸ” Copilot Resolve é¢„è§ˆ"
            echo ""
            echo "### å†²çªæ£€æµ‹ç»“æœ"
            echo "| æŒ‡æ ‡ | æ•°é‡ |"
            echo "|------|------|"
            echo "| å¯ç›´æ¥ cherry-pick | ${{ steps.conflicts.outputs.success_count }} |"
            echo "| éœ€ Copilot å¤„ç† | ${{ steps.conflicts.outputs.conflict_count }} |"
            echo ""
            echo "### åˆ†ç»„è®¡åˆ’ (${{ steps.groups.outputs.group_count }} ç»„)"
            echo ""

            jq -r '.[] | "#### æ¨¡å—: \(.module) (\(.count) ä¸ª commit)\n| ä¼˜å…ˆçº§ | SHA | æè¿° |\n|--------|-----|------|\n" + ([.commits[] | "| \(.priority) | `\(.sha[:10])` | \(.message) |"] | join("\n")) + "\n"' /tmp/groups.json
          } >> "$GITHUB_STEP_SUMMARY"

      - name: Create Copilot Issues
        if: ${{ !inputs.dry_run && steps.conflicts.outputs.conflict_count != '0' }}
        env:
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: |
          FROM="${{ steps.tags.outputs.from }}"
          TO="${{ steps.tags.outputs.to }}"
          MAX_ISSUES=${{ inputs.max_issues }}
          PARENT_ISSUE="${{ inputs.issue_number }}"
          CREATED=0
          CREATED_ISSUES=""

          GROUP_COUNT=$(jq 'length' /tmp/groups.json)

          for i in $(seq 0 $((GROUP_COUNT - 1))); do
            if [ "$MAX_ISSUES" -gt 0 ] && [ "$CREATED" -ge "$MAX_ISSUES" ]; then
              echo "âš ï¸ å·²è¾¾åˆ°æœ€å¤§ Issue æ•°é‡é™åˆ¶ ($MAX_ISSUES)ï¼Œè·³è¿‡å‰©ä½™åˆ†ç»„"
              break
            fi

            GROUP=$(jq ".[$i]" /tmp/groups.json)
            MODULE=$(echo "$GROUP" | jq -r '.module')
            COUNT=$(echo "$GROUP" | jq -r '.count')
            PRIORITIES=$(echo "$GROUP" | jq -r '.priorities')

            echo ""
            echo "â”â”â” åˆ›å»º Issue: $MODULE ($COUNT ä¸ª commit) â”â”â”"

            # æ„å»º Issue body
            BODY_FILE="/tmp/issue-body-$i.md"

            cat > "$BODY_FILE" <<ISSUE_EOF
## ä»»åŠ¡

å°†ä»¥ä¸‹ $COUNT ä¸ªä¸Šæ¸¸ commit çš„ä¿®æ”¹è¯­ä¹‰åŒ–åº”ç”¨åˆ°æœ¬ forkã€‚è¿™äº› commit æ— æ³•ç›´æ¥ cherry-pickï¼ˆå­˜åœ¨å†²çªï¼‰ï¼Œéœ€è¦ç†è§£ä¿®æ”¹æ„å›¾åæ‰‹åŠ¨åº”ç”¨ç­‰æ•ˆå˜æ›´ã€‚

### ä¸Šæ¸¸ç‰ˆæœ¬èŒƒå›´
- **æ¥æº**: openclaw/openclaw $FROM â†’ $TO
- **æ¨¡å—**: \`$MODULE\`
- **ä¼˜å…ˆçº§**: $PRIORITIES

### éœ€è¦ç§»æ¤çš„ commit

ISSUE_EOF

            # æ·»åŠ æ¯ä¸ª commit çš„è¯¦ç»† diff
            for j in $(seq 0 $((COUNT - 1))); do
              COMMIT=$(echo "$GROUP" | jq ".commits[$j]")
              SHA=$(echo "$COMMIT" | jq -r '.sha')
              MSG=$(echo "$COMMIT" | jq -r '.message')
              PRIORITY=$(echo "$COMMIT" | jq -r '.priority')
              FILES=$(echo "$COMMIT" | jq -r '.files')
              SHORT_SHA="${SHA:0:12}"

              cat >> "$BODY_FILE" <<COMMIT_EOF
#### Commit $((j+1)): \`$SHORT_SHA\` ($PRIORITY)
**æè¿°**: $MSG
**æ¶‰åŠæ–‡ä»¶**: \`$FILES\`

<details>
<summary>æŸ¥çœ‹ä¸Šæ¸¸ diff</summary>

\`\`\`diff
$(git show "$SHA" --format="" 2>/dev/null | head -200)
\`\`\`

</details>

COMMIT_EOF
            done

            # æ·»åŠ å“ç‰Œæ˜ å°„å’Œå·¥ä½œæŒ‡å—
            cat >> "$BODY_FILE" <<GUIDE_EOF
---

### å“ç‰Œæ˜ å°„è§„åˆ™

æœ¬ fork æ˜¯ openclaw/openclaw çš„ä¸­æ–‡ç‰ˆåˆ†æ”¯ï¼Œå“ç‰Œå’Œå‘½åæ˜ å°„å¦‚ä¸‹ï¼š
- æ–‡æ¡£/UI ä¸­çš„å“ç‰Œå: \`openclaw\` â†’ \`OpenClaw\`
- åŒ…å: \`openclaw\` â†’ \`openclaw-cn\`
- CLI å‘½ä»¤: \`openclaw\` â†’ \`openclaw-cn\`
- é…ç½®ç›®å½•: \`~/.openclaw/\` (ä¸ä¸Šæ¸¸ä¿æŒä¸€è‡´ï¼Œä¸è¦æ”¹åŠ¨)

### ä¸­æ–‡åŒ–è¦æ±‚

åˆå¹¶ä¸Šæ¸¸ä»£ç åï¼Œ**æ‰€æœ‰é¢å‘ç”¨æˆ·å¯è§çš„æ–‡æœ¬**ï¼ˆåŒ…æ‹¬ä½†ä¸é™äºï¼‰éƒ½å¿…é¡»ç¿»è¯‘æˆ**ç®€ä½“ä¸­æ–‡**ï¼š
- CLI è¾“å‡ºä¿¡æ¯ã€æç¤ºè¯­ã€é”™è¯¯æ¶ˆæ¯
- æ—¥å¿—ä¸­çš„ç”¨æˆ·å¯è§éƒ¨åˆ†
- æ³¨é‡Šä¸­çš„ç”¨æˆ·è¯´æ˜ï¼ˆä»£ç å†…éƒ¨æ³¨é‡Šå¯ä¿ç•™è‹±æ–‡ï¼‰
- é…ç½®æè¿°æ–‡æœ¬

### å·¥ä½œæŒ‡å—

1. **è·å–ä¸Šæ¸¸ä»£ç ** (å¦‚æœéœ€è¦æŸ¥çœ‹æ›´å¤šä¸Šä¸‹æ–‡):
   \`\`\`bash
   git remote add upstream https://github.com/openclaw/openclaw.git 2>/dev/null || true
   git fetch upstream --tags
   \`\`\`

2. **ç†è§£ä¿®æ”¹æ„å›¾**: ä»”ç»†é˜…è¯»ä¸Šæ¸¸ diffï¼Œç†è§£æ¯ä¸ªæ”¹åŠ¨çš„ç›®çš„

3. **æ‰¾åˆ° fork ä¸­å¯¹åº”ä½ç½®**: æ–‡ä»¶è·¯å¾„å¯èƒ½ç›¸åŒï¼Œä½†å†…å®¹å› å“ç‰Œé‡å‘½åæœ‰å·®å¼‚

4. **ä»£ç è´¨é‡è¯„ä¼°**: å¦‚æœä¸Šæ¸¸å’Œæœ¬ fork å¯¹ç›¸åŒåŠŸèƒ½æœ‰ä¸åŒå®ç°ï¼Œè¯·æ¯”è¾ƒä¸¤è¾¹çš„ä»£ç è´¨é‡ï¼ˆå¯è¯»æ€§ã€å¥å£®æ€§ã€æ€§èƒ½ï¼‰ï¼Œé€‰æ‹©è´¨é‡æ›´å¥½çš„å®ç°ã€‚ä¸è¦ç›²ç›®ç”¨ä¸Šæ¸¸ä»£ç è¦†ç›–æœ¬åœ°å·²æœ‰çš„ä¼˜è´¨å®ç°

5. **ä¿æŒç°æœ‰å®ç°ç¨³å®š**: å†²çªè§£å†³æ—¶å°½é‡ä¸è¦ç ´åæœ¬ fork ç°æœ‰çš„åŠŸèƒ½å®ç°ã€‚ä¼˜å…ˆé‡‡ç”¨æœ€å°æ”¹åŠ¨æ–¹å¼å¼•å…¥ä¸Šæ¸¸ä¿®å¤

6. **ä¿æŠ¤æœ¬åœ°æ–‡ä»¶**: ä»¥ä¸‹æ–‡ä»¶/ç›®å½•æ˜¯æœ¬ fork ç‹¬æœ‰çš„ï¼Œä¸è¦ä¿®æ”¹ï¼š
   - \`docs/\` (å·²æœ¬åœ°åŒ–)
   - \`.github/workflows/\` (è‡ªå®šä¹‰ CI)
   - \`CHANGELOG.md\`, \`README.md\` (æœ¬åœ°åŒ–)
   - \`package.json\` (å“ç‰Œ/åç§°/é…ç½®å·®å¼‚)
   - \`extensions/feishu/\` (é£ä¹¦æ¸ é“ï¼Œä¸Šæ¸¸æ— æ­¤æ‰©å±•)

7. **éªŒè¯**: ä¿®æ”¹å®Œæˆåè¿è¡Œ \`pnpm build\` ç¡®ä¿ç¼–è¯‘é€šè¿‡

### éªŒæ”¶æ ‡å‡†

- [ ] æ‰€æœ‰ commit çš„ä¿®æ”¹æ„å›¾å·²æ­£ç¡®ç†è§£å¹¶åº”ç”¨
- [ ] å“ç‰Œåç§°æ­£ç¡®æ˜ å°„ (OpenClaw / openclaw-cn)
- [ ] ç”¨æˆ·å¯è§æ–‡æœ¬å·²ç¿»è¯‘ä¸ºç®€ä½“ä¸­æ–‡
- [ ] æœªä¿®æ”¹å—ä¿æŠ¤æ–‡ä»¶
- [ ] ç°æœ‰åŠŸèƒ½å®ç°æœªè¢«ç ´å
- [ ] ä»£ç é£æ ¼ä¸ fork ç°æœ‰ä»£ç ä¸€è‡´
GUIDE_EOF

            # åˆ›å»º Issue
            ISSUE_TITLE="upstream($MODULE): ç§»æ¤ $COUNT ä¸ªå†²çª commit ($PRIORITIES) â€” $FROMâ†’$TO"

            gh label create "copilot-resolve" --color "7057ff" --force -R "$GITHUB_REPOSITORY" 2>/dev/null || true

            ISSUE_URL=$(gh issue create -R "$GITHUB_REPOSITORY" \
              --title "$ISSUE_TITLE" \
              --body-file "$BODY_FILE" \
              --label "upstream,copilot-resolve")

            ISSUE_NUM=$(echo "$ISSUE_URL" | grep -oE '[0-9]+$')
            echo "âœ… åˆ›å»º Issue #$ISSUE_NUM: $ISSUE_TITLE"

            # åˆ†é… Copilot Agent
            echo "ğŸ¤– åˆ†é…ç»™ Copilot Agent..."

            # é€šè¿‡ API åˆ†é… Copilot
            ASSIGN_RESULT=$(gh api -X POST \
              "repos/$GITHUB_REPOSITORY/issues/$ISSUE_NUM/assignees" \
              -f 'assignees[]=copilot-swe-agent' 2>&1) || true

            # æ£€æŸ¥åˆ†é…ç»“æœ
            ASSIGNED=$(echo "$ASSIGN_RESULT" | jq -r '.assignees[]?.login // empty' 2>/dev/null | head -1)
            if [ -n "$ASSIGNED" ]; then
              echo "   âœ… å·²åˆ†é…ç»™ $ASSIGNED"
            else
              echo "   âš ï¸ API åˆ†é…æœªç”Ÿæ•ˆï¼Œå¯èƒ½éœ€è¦åœ¨ GitHub UI ä¸­æ‰‹åŠ¨åˆ†é… Copilot"
            fi

            CREATED=$((CREATED + 1))
            CREATED_ISSUES="$CREATED_ISSUES #$ISSUE_NUM"

            # é¿å… API rate limit
            sleep 2
          done

          echo ""
          echo "========================================="
          echo "ğŸ‰ å…±åˆ›å»º $CREATED ä¸ª Copilot Issue"
          echo "   Issues: $CREATED_ISSUES"
          echo "========================================="

          # è¾“å‡ºåˆ° GITHUB_OUTPUT
          echo "created_count=$CREATED" >> "$GITHUB_OUTPUT"
          echo "created_issues=$CREATED_ISSUES" >> "$GITHUB_OUTPUT"

      # ============================================================
      # æ­¥éª¤ 4: å›æŠ¥ç»“æœåˆ°ä¸Šæ¸¸ Issue
      # ============================================================
      - name: Report to parent Issue
        if: ${{ !inputs.dry_run && inputs.issue_number != '' && steps.conflicts.outputs.conflict_count != '0' }}
        env:
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: |
          ISSUE="${{ inputs.issue_number }}"

          {
            echo "## ğŸ¤– Copilot Agent å†²çªè§£å†³å·²å¯åŠ¨"
            echo ""
            echo "| æŒ‡æ ‡ | æ•°é‡ |"
            echo "|------|------|"
            echo "| å¯ç›´æ¥ cherry-pick | ${{ steps.conflicts.outputs.success_count }} |"
            echo "| éœ€ Copilot å¤„ç† | ${{ steps.conflicts.outputs.conflict_count }} |"
            echo "| å·²åˆ›å»º Copilot Issue | ${{ steps.groups.outputs.group_count }} ç»„ |"
            echo ""
            echo "### Copilot Issue åˆ—è¡¨"
            echo ""
            echo "ä»¥ä¸‹ Issue å·²åˆ†é…ç»™ Copilot Agentï¼Œæ¯ä¸ª Issue å¯¹åº”ä¸€ä¸ªæ¨¡å—çš„å†²çª commitï¼š"
            echo ""

            # åˆ—å‡ºå·²åˆ›å»ºçš„ Issue
            jq -r '.[] | "- **\(.module)** (\(.count) ä¸ª commit, \(.priorities))"' /tmp/groups.json

            echo ""
            echo "> ğŸ’¡ Copilot Agent å°†è‡ªåŠ¨ä¸ºæ¯ä¸ª Issue åˆ›å»º PRã€‚å®Œæˆåè¯·äººå·¥å®¡æŸ¥å¹¶åˆå¹¶ã€‚"
          } > /tmp/parent-comment.md

          gh issue comment "$ISSUE" -R "$GITHUB_REPOSITORY" --body-file /tmp/parent-comment.md

      - name: Summary
        if: always()
        run: |
          {
            echo "## ğŸ¤– Copilot Resolve ç»“æœ"
            echo ""
            echo "| æŒ‡æ ‡ | æ•°é‡ |"
            echo "|------|------|"
            echo "| æ€» commit | ${{ steps.conflicts.outputs.total }} |"
            echo "| âœ… å¯ç›´æ¥ cherry-pick | ${{ steps.conflicts.outputs.success_count }} |"
            echo "| âŒ éœ€ Copilot å¤„ç† | ${{ steps.conflicts.outputs.conflict_count }} |"
            if [ "${{ steps.conflicts.outputs.conflict_count }}" != "0" ]; then
              echo "| ğŸ“¦ åˆ†ç»„æ•° | ${{ steps.groups.outputs.group_count }} |"
            fi
            echo ""
            if [ "${{ inputs.dry_run }}" = "true" ]; then
              echo "> â„¹ï¸ é¢„è§ˆæ¨¡å¼ï¼Œæœªåˆ›å»º Issue"
            fi
          } >> "$GITHUB_STEP_SUMMARY"
